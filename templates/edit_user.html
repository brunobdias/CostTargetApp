{% extends "layout.html" %}

{% block content %}

<h3 class="mb-4">Edit User</h3>

<div class="card shadow-sm">
    <div class="card-body">

        <form method="POST" action="{{ url_for('edit_user', username=user.username) }}">

            <div class="row g-3">

                <!-- Username (READ-ONLY) -->
                <div class="col-md-4">
                    <label class="form-label fw-bold">Username</label>
                    <input type="text"
                           class="form-control"
                           value="{{ user.username }}"
                           readonly>
                </div>

                <!-- Display Name -->
                <div class="col-md-4">
                    <label class="form-label fw-bold">Display Name</label>
                    <input type="text"
                           name="displayname"
                           class="form-control"
                           value="{{ user.displayname }}">
                </div>

                <!-- Role -->
                <div class="col-md-4">
                    <label class="form-label fw-bold">Role</label>
                    <select name="role" class="form-select">
                        <option value="user"
                            {% if user.role == 'user' %}selected{% endif %}>
                            User
                        </option>
                        <option value="admin"
                            {% if user.role == 'admin' %}selected{% endif %}>
                            Admin
                        </option>
                    </select>
                </div>

                <!-- Active -->
                <div class="col-md-4">
                    <label class="form-label fw-bold">Active</label>
                    <select name="is_active" class="form-select">
                        <option value="1"
                            {% if user.is_active %}selected{% endif %}>
                            Active
                        </option>
                        <option value="0"
                            {% if not user.is_active %}selected{% endif %}>
                            Inactive
                        </option>
                    </select>
                </div>

                <div class="col-12 text-end mt-3">
                    <a href="{{ url_for('users_page') }}" class="btn btn-secondary me-2">
                        Cancel
                    </a>
                    <button type="submit" class="btn btn-primary">
                        Save Changes
                    </button>
                </div>

            </div>

        </form>
    </div>
</div>

<script>
    window.existingDepts = {{ dept_ids | tojson | safe }};
</script>

<script src="{{ url_for('static', filename='js/edit_validation.js') }}"></script>

{% endblock %}
